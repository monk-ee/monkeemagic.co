<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>monkee magic</title>
  <meta name="description" content="a site which is an example of sites">
  <meta name="author" content="">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <link rel="alternate" type="application/rss+xml" href="http://monkeemagic.io/rss.xml" title="RSS">
  <link rel="stylesheet" href="./frontend/style.css?v=1">
  <script type="text/javascript" src="./frontend/js.js"></script>
</head>
  <body class="posts">
    <div id="masthead">
      <h1>monkeemagic.co</h1>
      <h2>
      build make deploy</h2>
      <div id="nav">
        <a href="/" class="posts">POSTS</a>
        <a href="/cv" class="cv">CV</a>
        <a href="https://twitter.com/monkee_magic">TWITTER</a>
        <a href="https://github.com/monk-ee">GITHUB</a>
        <a href="https://au.linkedin.com/pub/lyndon-swan/b/8bb/754/">LINKEDIN</a>
      </div>
    </div>
    <div id="page">

      
      <div class="posts">
  <div class="post introduction">
    <div class="header">
      <h1><a href="/posts/introduction/">All the limits in the world……</a></h1>
      <small>Written by Monkee. Saturday, December 28 2013.</small>
      <div class="tags"><small><a href="tagged/limits" class="tag">limits</a><a href="tagged/elasticsearch" class="tag">elasticsearch</a><a href="tagged/ubuntu" class="tag">ubuntu</a><a href="tagged/debian" class="tag">debian</a></small></div>
    </div>
    <div class="body">
    
<p>I had trouble finding all the places to change max files that can be opened on Ubuntu and Debian in one spot.</p>

<p>So here we go:</p>

<h3 id="step_1">Step 1</h3>

<p>First modify /etc/sysctl.conf add the following line: need I say check that it isn’t there already?</p>

<pre><code>fs.file-max = 131072</code></pre>

<p>To avoid a reboot type in the following to reread the configuration and apply it to the system.</p>

<pre><code>sysctl -p</code></pre>

<h3 id="step_2">Step 2</h3>

<p>Now include the pam limits shared library to:</p>

<pre><code>/etc/pam.d/common-session
/etc/pam.d/common-session-interactive</code></pre>

<p>The syntax follows:</p>

<pre><code>session required pam_limits.so</code></pre>

<h3 id="step_3">Step 3</h3>

<p>You are ready to modify the limits config file (/etc/security/limits.conf):</p>

<pre><code>elasticsearch  -  nofile   131072
elasticsearch  -  memlock  unlimited</code></pre>

    
    </div>
    <div class="footer">

    </div>
  </div>
  <div class="post elasticsearch">
    <div class="header">
      <h1><a href="/posts/elasticsearch/">Add Shard Replicas to Elasticsearch</a></h1>
      <small>Written by Monkee. Thursday, December 19 2013.</small>
      <div class="tags"><small><a href="tagged/shards" class="tag">shards</a><a href="tagged/elasticsearch" class="tag">elasticsearch</a><a href="tagged/ubuntu" class="tag">ubuntu</a><a href="tagged/debian" class="tag">debian</a></small></div>
    </div>
    <div class="body">
    
<p>As addendum to the previous post about corrupt Elasticsearch Shards, here is the command to increase your shard replicas.</p>

<p>For the entire cluster; for craps sake make sure you have enough disk space for this:</p>

<pre><code>curl -XPUT 'localhost:9200/_settings' -d  '{ &quot;index&quot; : { &quot;number_of_replicas&quot; : 2 } }'</code></pre>

<p>For a specific index use this command:</p>

<pre><code>curl -XPUT 'localhost:9200/&lt;index_name&gt;/_settings' -d  '{ &quot;index&quot; : { &quot;number_of_replicas&quot; : 2 } }'</code></pre>

    
    </div>
    <div class="footer">

    </div>
  </div>
</div>
<div class="pagination">
  
  
</div>


    </div>
    <div id="footer">
      <hr>
      <small>Powered by <a href="https://github.com/danielsim/Plateau">Plateau</a></small>
    </div>
  </body>
</html>